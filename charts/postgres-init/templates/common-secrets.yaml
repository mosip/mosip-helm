apiVersion: v1
kind: Secret
metadata:
  name: db-secrets
  namespace: {{ .Release.Namespace }}
  labels: {{- include "common.labels.standard" . | nindent 4 }}
    app.kubernetes.io/component: postgres
    {{- if .Values.commonLabels }}
    {{- include "common.tplvalues.render" ( dict "value" .Values.commonLabels "context" $ ) | nindent 4 }}
    {{- end }}
  {{- if .Values.commonAnnotations }}
  annotations: {{- include "common.tplvalues.render" ( dict "value" .Values.commonAnnotations "context" $ ) | nindent 4 }}
  {{- end }}
type: Opaque
data:
  {{- if .Values.databases.mosip_master.enabled }}
  {{- if .Values.databases.mosip_master.dbuser.password }}
  db-mosip-master-password: {{ .Values.databases.mosip_master.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-master-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}


  {{- if .Values.databases.mosip_audit.enabled }}
  {{- if .Values.databases.mosip_audit.dbuser.password }}
  db-mosip-audit-password: {{ .Values.databases.mosip_audit.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-audit-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_keymgr.enabled }}
  {{- if .Values.databases.mosip_keymgr.dbuser.password }}
  db-mosip-keymgr-password: {{ .Values.databases.mosip_keymgr.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-keymgr-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_kernel.enabled }}
  {{- if .Values.databases.mosip_kernel.dbuser.password }}
  db-mosip-kernel-password: {{ .Values.databases.mosip_kernel.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-kernel-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_idmap.enabled }}
  {{- if .Values.databases.mosip_idmap.dbuser.password }}
  db-mosip-idmap-password: {{ .Values.databases.mosip_idmap.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-idmap-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_prereg.enabled }}
  {{- if .Values.databases.mosip_prereg.dbuser.password }}
  db-mosip-prereg-password: {{ .Values.databases.mosip_prereg.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-prereg-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_idrepo.enabled }}
  {{- if .Values.databases.mosip_idrepo.dbuser.password }}
  db-mosip-idrepo-password: {{ .Values.databases.mosip_idrepo.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-idrepo-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_ida.enabled }}
  {{- if .Values.databases.mosip_ida.dbuser.password }}
  db-mosip-ida-password: {{ .Values.databases.mosip_ida.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-ida-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_credential.enabled }}
  {{- if .Values.databases.mosip_credential.dbuser.password }}
  db-mosip-credential-password: {{ .Values.databases.mosip_credential.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-credential-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_regprc.enabled }}
  {{- if .Values.databases.mosip_regprc.dbuser.password }}
  db-mosip-regprc-password: {{ .Values.databases.mosip_regprc.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-regprc-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_regdevice.enabled }}
  {{- if .Values.databases.mosip_regdevice.dbuser.password }}
  db-mosip-regdevice-password: {{ .Values.databases.mosip_regdevice.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-regdevice-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_authdevice.enabled }}
  {{- if .Values.databases.mosip_authdevice.dbuser.password }}
  db-mosip-authdevice-password: {{ .Values.databases.mosip_authdevice.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-authdevice-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_pms.enabled }}
  {{- if .Values.databases.mosip_pms.dbuser.password }}
  db-mosip-pms-password: {{ .Values.databases.mosip_pms.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-pms-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_hotlist.enabled }}
  {{- if .Values.databases.mosip_hotlist.dbuser.password }}
  db-mosip-hotlist-password: {{ .Values.databases.mosip_hotlist.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-hotlist-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_resident.enabled }}
  {{- if .Values.databases.mosip_resident.dbuser.password }}
  db-mosip-resident-password: {{ .Values.databases.mosip_resident.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-resident-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_toolkit.enabled }}
  {{- if .Values.databases.mosip_toolkit.dbuser.password }}
  db-mosip-toolkit-password: {{ .Values.databases.mosip_toolkit.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-toolkit-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}

  {{- if .Values.databases.mosip_digitalcard.enabled }}
  {{- if .Values.databases.mosip_digitalcard.dbuser.password }}
  db-mosip-digitalcard-password: {{ .Values.databases.mosip_digitalcard.dbuser.password | b64enc | quote}}
  {{- else }}
  db-mosip-digitalcard-password: {{ randAlphaNum 10 | b64enc | quote }}
  {{- end }}
  {{- end }}